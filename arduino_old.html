<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>arduino.js: JavaScript-to-Arduino I/O control interface</title>

<!-- core library -->
<script src="script/arduino.js"></script>

<!-- demo app, you can remove this.. -->
<script src="demo/demo.js"></script>

<link rel="stylesheet" media="screen" href="demo/demo.css" />
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script>



// arduino.js: crash-course intro (config/setup for your own use)

// specify where to find the flash (used for socket connection and control protocol)
arduino.config.flash.url = 'swf/arduinojs.swf';

// enable debugging to JS console (useful when prototyping)
//arduino.config.debug.enabled = true;

// include flash-based debug console messages
//arduino.config.flash.debug = true;

// true = show flash UI on-screen (good for initial set-up / troubleshooting)
arduino.config.flash.showUI = false;

// fallback: allow fake connections if socket fails, for testing offline etc.
arduino.config.debug.offlineMode = true;

// finally, connect when flash has loaded.
// demo.js sets its own handlers, but here is a basic example:


/* 
arduino.onload = function() {

  arduino.connect('127.0.0.1', 5331, function() {
    // yay, we are now connected and ready to go.
    //console.log(arduino.getAnalogData(1));				  
    //document.getElementById('dataspit').innerHTML = stuff;
   
	    
  });

};
*/

function doStuff() {

    function readData() {

  	console.log('Pin 13 value: ' + arduino.getDigitalData(13));
  	console.log('Analog input 0 value: ' + arduino.getAnalogData(1));
  	var stuff = arduino.getAnalogData(1);
  	var a=0;
	
	}
	
	setInterval(readData, 100);

}



</script>
<script type="text/javascript">


    
      // Load the Visualization API and the piechart package.
      google.load('visualization', '1.0', {'packages':['corechart']});
      
      // Set a callback to run when the Google Visualization API is loaded.
      //google.setOnLoadCallback(drawChart);
		var persecond = 50; //If no value use default
     	var seconds = 1;
     	var timeinc = 1000/persecond; //This is the time increment for the data table 
		var range = persecond*seconds;
		var time = timeinc;
		var alldatatext = new Array();  // Puts data into rows for Google charts
		for (j=0; j < range; j++) {

				alldatatext[j] = [time, 0];
				time = time + timeinc;
			};
		m = 0;
		var exportData = new Array(); //Array that will be output into a spreadsheet


		var interval;

     function addRandom() {
		      interval = setInterval("drawChart()",100);
	}

      // Callback that creates and populates a data table, 
      // instantiates the pie chart, passes in the data and
      // draws it.
      function drawChart() {


      if(document.getElementById('title').value.length !== 0){
				var title = document.getElementById('title').value; // Get the value of data values per second from the form
		} else {
			var title = "My Default Title"; //If no value use default
		}

	if(document.getElementById('measure').value.length !== 0){
				var measure = document.getElementById('measure').value; // Get the value of data values per second from the form
		} else {
			var measure = "Amount of ambient light"; //If no value use default
		}

      // Create the data table.
      var data = new google.visualization.DataTable();
      data.addColumn('number', 'miliseconds');
      data.addColumn('number', 'Value');

      

		// Set chart options
      		var options = {'title': title,
                     'width':800,
                     'height':500,
                 	 'curveType' : 'function', 
                 	 'legend' : 'none', 
                 	 'vAxis': {maxValue: 120, minValue: -120, title: measure },
                 	 'hAxis' : {title: "Miliseconds" }
                 	};	      
		

			var number = arduino.getAnalogData(1);		  	

		  	
		  	alldatatext.shift();
			alldatatext.push([time, number]);
			time = time + timeinc;
			

			for (m =  0 ; m < range; m++) {
				data.addRows([alldatatext[m]]);
			};

			document.getElementById('current').innerHTML = number;

			var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
		
			//document.getElementById('data').innerHTML = alldatatext;
			chart.draw(data, options);
			
		
			      // Instantiate and draw our chart, passing in some options.
			      


    }


    </script>



</head>

<body>
<div id="header"> <h1>Random Graph Generator </h1><p>This page generates a graph each time you click "generate" to test the graphing functionalities of <a href="http://code.google.com/apis/chart/" >Google Charts </a>. </p>
	<p> This is version 3 (it may overload your processor a bit, very hastily done!), try <a href="index.html">version 1</a>, and <a href="random2.html">version 2 </a> and a <a href="gauage.html"> Gauage example </a>. </p>

	Provide a title for the Chart: <input type="text" id="title"  size="20"> <br />
	What are you measuring? <input type="text" id="measure" size="20"><br />
<div id="button"> 
	<form id="generateform">
		
		<input type="button" id="generate" value="Generate" onClick="addRandom()" > 
		<input type="button" id="stop" value="Stop" onclick="window.clearInterval(interval)" >

		<div id="data"> </div>
	</form>
	<br />
	<div id="elapsed"></div>
	
<div> 

<!--Div that will hold the pie chart-->
    <div id="chart_div" style="width:400; height:300"></div>
    <div id="current"></div>
    

<div id="content">
<h1 id="dataspit">Test</h1>
<input type="button" onclick="doStuff()" value="Do it!"> 

 <h1><span><a href="http://www.schillmania.com/projects/arduino-js" title="arduino.js: JavaScript / Arduino Uno communication API">arduino.js</a></span></h1>
 <p>JavaScript-based Arduino Uno communication</p>

 <p id="publish-date" title="Publish date">version: 2010.10.31</p>

 <div id="device-status">
  <p id="device-status-text"><button id="do-connect" onclick="startArduinoDemo()" title="Attempt to connect to an arduino device via socks/serial proxy" disabled="disabled">Connect</button></p>
 </div>

 <div id="pins" class="column-wrapper">

  <div class="column">

   <h2><span>Analog Inputs</span></h2>
   <ul>
    <li>A<sub>in0</sub>: <span id="analog-pin0-value"> </span></li>
    <li>A<sub>in1</sub>: <span id="analog-pin1-value"> </span></li>
    <li>A<sub>in2</sub>: <span id="analog-pin2-value"> </span></li>
    <li>A<sub>in3</sub>: <span id="analog-pin3-value"> </span></li>
    <li>A<sub>in4</sub>: <span id="analog-pin4-value"> </span></li>
    <li>A<sub>in5</sub>: <span id="analog-pin5-value"> </span></li>
   </ul>
	
   <div id="canvas-box">
    <canvas id="arduino-canvas" width="256" height="336">This is a &lt;canvas&gt; element. You need a better browser to see the data visualization.</canvas>
   </div>

   <p>
    <button onclick="window.clearTimeout(arduinoTimer);arduinoTimer=null;this.disabled='disabled'">Stop updating</button>
   </p>

   <p>Apply variable current to the analog inputs (eg. a potentiometer) to see live graphs.</p>

  </div>

  <div class="column">

   <h2><span>Standard I/O Pins</span></h2>
   <ul>
    <li>Pin 2 <span id="pin2-value"> </span> <span id="pin2-button"></span></li>
    <li>Pin 3 <span id="pin3-value"> </span> <span id="pin3-button"></span></li>
    <li>Pin 4 <span id="pin4-value"> </span> <span id="pin4-button"></span></li>
    <li>Pin 5 <span id="pin5-value"> </span> <span id="pin5-button"></span></li>
    <li>Pin 6 <span id="pin6-value"> </span> <span id="pin6-button"></span></li>
    <li>Pin 7 <span id="pin7-value"> </span> <span id="pin7-button"></span></li>
    <li>Pin 8 <span id="pin8-value"> </span> <span id="pin8-button"></span></li>
    <li>Pin 9 <span id="pin9-value"> </span> <span id="pin9-button"></span></li>
    <li>Pin 10 <span id="pin10-value"> </span> <span id="pin10-button"></span></li>
    <li>Pin 11 <span id="pin11-value"> </span> <span id="pin11-button"></span></li>
    <li>Pin 12 <span id="pin12-value"> </span> <span id="pin12-button"></span></li>
    <li>Pin 13 <span id="pin13-value"> </span> <span id="pin13-button"></span></li>
   </ul>

   <h2 style="margin-top:1.5em"><span>Pin 13/LED Blink Test</span></h2>
   <p>Pin 13 typically has a surface-mount LED (eg. as with the Uno) representing binary output.</p>
   <p>Interval (msec): &nbsp;<input id="blink-interval" type="text" value="1000" style="width:5em" /></p>

  </div>

 </div>




</body>
</html>